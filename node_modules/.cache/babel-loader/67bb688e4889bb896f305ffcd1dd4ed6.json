{"ast":null,"code":"var _jsxFileName = \"/home/csgarciamartinez/Telar/telar-client/src/Sala.js\",\n    _s = $RefreshSig$();\n\nimport { io } from 'socket.io-client';\nimport Jugador from './Jugador';\nimport ItemTypes from './ItemTypes';\nimport React from 'react';\nimport { useEffect, useState, useRef } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport './sala.css';\nimport { DndProvider, useDrag, useDrop } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst fs = require('./server/funcionesServidor.js'); //Sala. Props inclused sala and socket info\n//TODO: Fix everything related to \"espera\", incl the fact you can play during it\n\n\nconst Sala = _ref => {\n  _s();\n\n  let {\n    sala,\n    socket,\n    setSala,\n    setTurno,\n    setRonda\n  } = _ref;\n  console.log(sala);\n  console.log(`Se actualizo la sala de juego`);\n  var jugadores = [];\n  const client = socket;\n  var espera = \"\";\n  var usr_id = 0; //La posicion del jugador en la sala\n\n  useEffect(() => {\n    console.log(sala);\n  }, [sala]); //FUNCIONES PARA MULTIPLAYER LOCAL. EN TAL CASO SALA.JS TIENE LAS FUNCIONES DEL SERVIDOR\n\n  const comenzar = () => {\n    if (!sala[\"local\"]) {\n      console.log(`Se mando un request para comenzar el juego`);\n      socket.current.emit('comenzar-juego', sala[\"sala\"]);\n    } else {\n      sala = fs.comenzarJuego(sala);\n      setSala(sala);\n      setTurno(0);\n      setRonda(0);\n    }\n  };\n\n  const hacerJugada = state => {\n    console.log(sala[\"usuarios\"][sala[\"turno\"]]);\n    sala[\"usuarios\"][sala[\"turno\"]][\"canasta\"] = [];\n    var siguiente = sala[\"turno\"] + 1; //El siguiente jugador\n\n    if (sala[\"turno\"] == sala[\"usuarios\"].length - 1) {\n      siguiente = 0;\n    }\n\n    for (const f in state[\"fichasEnCanasta\"]) {\n      sala[\"usuarios\"][siguiente][\"canasta\"].push(state[\"fichasEnCanasta\"][f]);\n    }\n\n    sala[\"turno\"] = sala[\"usuarios\"][siguiente][\"usuario\"];\n    sala[\"sala\"] = sala[\"turno\"];\n    setTurno(sala[\"turno\"]);\n    setSala(sala);\n  }; //CREAR LOS JUGADORES\n\n\n  if (sala[\"activo\"]) {\n    for (const usr in sala[\"usuarios\"]) {\n      console.log(sala[\"usuarios\"][usr][\"usuario\"]);\n      console.log(client.current.id);\n\n      if (sala[\"usuarios\"][usr][\"usuario\"] == client.current.id || sala[\"local\"] && sala[\"turno\"] == usr) {\n        jugadores.push( /*#__PURE__*/_jsxDEV(Jugador, {\n          jugador: usr,\n          activo: true,\n          sala: sala,\n          socket: client,\n          hacerJugada: hacerJugada\n        }, sala[\"usuarios\"][usr][\"usuario\"], false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 24\n        }, this));\n      } else {\n        jugadores.push( /*#__PURE__*/_jsxDEV(Jugador, {\n          jugador: usr,\n          activo: false,\n          sala: sala,\n          socket: client\n        }, sala[\"usuarios\"][usr][\"usuario\"], false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 24\n        }, this));\n      }\n    }\n  } else {\n    for (const usr in sala[\"usuarios\"]) {\n      jugadores.push( /*#__PURE__*/_jsxDEV(Jugador, {\n        jugador: usr,\n        sala: sala\n      }, sala[\"usuarios\"][usr][\"usuario\"], false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 22\n      }, this));\n    }\n  }\n\n  if (sala[\"espera\"]) {\n    espera = \"espera\";\n  }\n\n  return /*#__PURE__*/_jsxDEV(DndProvider, {\n    backend: HTML5Backend,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Sala de juego \\\"\", sala[\"sala\"], \"\\\"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: espera,\n        children: \" \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"sala\",\n        children: sala[\"activo\"] ? /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"jugadores\",\n          children: jugadores\n        }, \"boards1\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"jugadores\",\n            children: jugadores\n          }, \"boards2\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"comenzarBtn\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: comenzar,\n              children: \"Comenzar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Sala, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = Sala;\nexport default Sala;\n\nvar _c;\n\n$RefreshReg$(_c, \"Sala\");","map":{"version":3,"names":["io","Jugador","ItemTypes","React","useEffect","useState","useRef","ReactDOM","DndProvider","useDrag","useDrop","HTML5Backend","fs","require","Sala","sala","socket","setSala","setTurno","setRonda","console","log","jugadores","client","espera","usr_id","comenzar","current","emit","comenzarJuego","hacerJugada","state","siguiente","length","f","push","usr","id"],"sources":["/home/csgarciamartinez/Telar/telar-client/src/Sala.js"],"sourcesContent":["import { io } from 'socket.io-client';\nimport Jugador from './Jugador';\nimport ItemTypes from './ItemTypes'\nimport React from 'react';\nimport { useEffect, useState, useRef } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport'./sala.css';\nimport {DndProvider, useDrag, useDrop} from 'react-dnd'\nimport{HTML5Backend} from 'react-dnd-html5-backend'\n\nconst fs = require('./server/funcionesServidor.js');\n\n\n//Sala. Props inclused sala and socket info\n//TODO: Fix everything related to \"espera\", incl the fact you can play during it\nconst Sala = ({sala, socket, setSala, setTurno, setRonda}) => {\n  console.log(sala)\n  console.log(`Se actualizo la sala de juego`)\n  var jugadores = [];\n\n  const client = socket;\n  var espera = \"\"\n  var usr_id = 0 //La posicion del jugador en la sala\n\n  useEffect(() => {\n    console.log(sala)\n  }, [sala])\n\n  //FUNCIONES PARA MULTIPLAYER LOCAL. EN TAL CASO SALA.JS TIENE LAS FUNCIONES DEL SERVIDOR\n\n  const comenzar = () =>{\n    if(!sala[\"local\"]){\n      console.log(`Se mando un request para comenzar el juego`);\n      socket.current.emit('comenzar-juego', sala[\"sala\"]);\n    } else {\n      sala = fs.comenzarJuego(sala)\n      setSala(sala)\n      setTurno(0)\n      setRonda(0)\n    }\n  }\n\n  const hacerJugada = (state) => {\n    console.log(sala[\"usuarios\"][sala[\"turno\"]])\n    sala[\"usuarios\"][sala[\"turno\"]][\"canasta\"] = []\n    var siguiente = sala[\"turno\"] + 1 //El siguiente jugador\n    if(sala[\"turno\"] == sala[\"usuarios\"].length-1){\n      siguiente = 0\n    }\n    for(const f in state[\"fichasEnCanasta\"]){\n      sala[\"usuarios\"][siguiente][\"canasta\"].push(state[\"fichasEnCanasta\"][f])\n    }\n    sala[\"turno\"] = sala[\"usuarios\"][siguiente][\"usuario\"] \n    sala[\"sala\"] = sala[\"turno\"];\n    setTurno(sala[\"turno\"])\n    setSala(sala)\n  }\n\n\n  //CREAR LOS JUGADORES\n  if(sala[\"activo\"]){\n    for(const usr in sala[\"usuarios\"]){\n      console.log(sala[\"usuarios\"][usr][\"usuario\"])\n      console.log(client.current.id)\n      if(sala[\"usuarios\"][usr][\"usuario\"] == client.current.id || (sala[\"local\"] && sala[\"turno\"] == usr)){\n        jugadores.push(<Jugador jugador = {usr}\n                              activo = {true}\n                              sala = {sala}\n                              socket = {client}\n                              hacerJugada = {hacerJugada}\n                              key = {sala[\"usuarios\"][usr][\"usuario\"]}/>)\n      } else {\n        jugadores.push(<Jugador jugador = {usr}\n                              activo = {false}\n                              sala = {sala}\n                              socket = {client}\n                              key = {sala[\"usuarios\"][usr][\"usuario\"]}/>)\n      }\n    }\n  } else {\n    for(const usr in sala[\"usuarios\"]){\n      jugadores.push(<Jugador jugador = {usr}\n                              sala = {sala} \n                              key={sala[\"usuarios\"][usr][\"usuario\"]}/>);\n    }\n  }\n\n  if(sala[\"espera\"]){\n    espera = \"espera\"\n  }\n\n  return(\n    <DndProvider backend={HTML5Backend}>\n    <div> \n      <h1>Sala de juego \"{sala[\"sala\"]}\"</h1>\n      <div id = {espera}> </div>\n      <div class =\"sala\">\n        {sala[\"activo\"]\n          ? \n            <div class=\"jugadores\" key=\"boards1\">{jugadores}</div>\n            :\n            <div>\n            <div class=\"jugadores\" key=\"boards2\"> \n            {jugadores}\n            </div>\n            <div id=\"comenzarBtn\">\n              <button onClick={comenzar}>\n                Comenzar\n              </button>\n            </div>\n          </div>\n        }\n      </div>\n    </div>\n    </DndProvider>\n  )\n}\n\nexport default Sala;"],"mappings":"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"},"metadata":{},"sourceType":"module"}