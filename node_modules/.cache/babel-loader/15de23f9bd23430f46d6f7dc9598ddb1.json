{"ast":null,"code":"var _jsxFileName = \"/home/csgarciamartinez/Telar/telar-client/src/Sala.js\";\nimport { io } from 'socket.io-client';\nimport Jugador from './Jugador';\nimport ItemTypes from './ItemTypes';\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport './sala.css';\nimport { DndProvider, useDrag, useDrop } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend'; //Called from Sala to start the game. Probably not in the right place\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction comenzar(skt, salaname) {\n  console.log(`Se mando un request para comenzar el juego`);\n  skt.current.emit('comenzar-juego', salaname);\n}\n\n;\n\nfunction GoButton(props) {\n  let onClick = () => alert(\"No es tu turno\");\n\n  let style = {\n    opacity: \"50%\"\n  };\n\n  if (props.jugador.props.socket) {\n    if (props.jugador.props.socket.current.id == props.turno) {\n      var quedanFichas = [];\n\n      for (const s in props.jugador.state.subset) {\n        var subs = [props.jugador.state.subset[s]];\n        quedanFichas.push(true);\n\n        for (const f in props.jugador.state.fichasEnCanasta) {\n          var ficha = props.jugador.state.fichasEnCanasta[f];\n\n          if (props.jugador.state.subset.includes(ficha[\"patron\"]) || props.jugador.state.subset.includes(ficha[\"color\"])) {\n            console.log(`Aun quedan fichas en subconjunto ${subs}`);\n            quedanFichas[s] = false;\n            break;\n          }\n        }\n      } // }\n\n\n      onClick = () => alert(\"Favor de seleccionar un subconjunto completo\");\n\n      if (quedanFichas.length > 0) {\n        if (quedanFichas.reduce((x, y) => x || y)) {\n          style = {};\n\n          onClick = () => alert(\"this.hacerJugada()\");\n        }\n      } else {\n        onClick = () => alert(\"this.hacerJugada()\");\n      }\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    style: style,\n    onClick: onClick,\n    children: \"Hacer jugada\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 12\n  }, this);\n} //Sala. Props inclused sala and socket info\n//TODO: Fix everything related to \"espera\", incl the fact you can play during it\n\n\n_c = GoButton;\n\nfunction Sala(props) {\n  console.log(`Se actualizo la sala de juego`);\n  var jugadores = [];\n  const client = props.socket;\n  const nombre = props.sala[\"sala\"];\n  var espera = \"\";\n  var usrIdx = 0; //La posicion del jugador en la sala\n\n  if (props.sala[\"activo\"]) {\n    for (const usr in props.sala[\"usuarios\"]) {\n      console.log(props.sala[\"usuarios\"][usr][\"usuario\"]);\n      console.log(client.current.id);\n\n      if (props.sala[\"usuarios\"][usr][\"usuario\"] == client.current.id) {\n        jugadores.push( /*#__PURE__*/_jsxDEV(Jugador, {\n          jugador: usr,\n          activo: true,\n          sala: props.sala,\n          socket: client\n        }, props.sala[\"usuarios\"][usr][\"usuario\"], false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 24\n        }, this));\n        usrIdx = usr;\n      } else {\n        jugadores.push( /*#__PURE__*/_jsxDEV(Jugador, {\n          jugador: usr,\n          activo: false,\n          sala: props.sala,\n          socket: client\n        }, props.sala[\"usuarios\"][usr][\"usuario\"], false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 24\n        }, this));\n      }\n    }\n  } else {\n    for (const usr in props.sala[\"usuarios\"]) {\n      jugadores.push( /*#__PURE__*/_jsxDEV(Jugador, {\n        jugador: usr,\n        sala: props.sala\n      }, props.sala[\"usuarios\"][usr][\"usuario\"], false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 22\n      }, this));\n    }\n  }\n\n  if (props.sala[\"espera\"]) {\n    espera = \"espera\";\n  }\n\n  return /*#__PURE__*/_jsxDEV(DndProvider, {\n    backend: HTML5Backend,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Sala de juego \\\"\", props.sala[\"sala\"], \"\\\"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: espera,\n        children: \" \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"sala\",\n        children: props.sala[\"activo\"] ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"jugadores\",\n            children: jugadores\n          }, \"boards1\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"comenzarBtn\",\n            children: /*#__PURE__*/_jsxDEV(GoButton, {\n              jugador: jugadores[usrIdx]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"jugadores\",\n            children: jugadores\n          }, \"boards2\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"comenzarBtn\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => comenzar(client, nombre),\n              children: \"Comenzar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n}\n\n_c2 = Sala;\nexport default Sala;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"GoButton\");\n$RefreshReg$(_c2, \"Sala\");","map":{"version":3,"names":["io","Jugador","ItemTypes","React","ReactDOM","DndProvider","useDrag","useDrop","HTML5Backend","comenzar","skt","salaname","console","log","current","emit","GoButton","props","onClick","alert","style","opacity","jugador","socket","id","turno","quedanFichas","s","state","subset","subs","push","f","fichasEnCanasta","ficha","includes","length","reduce","x","y","Sala","jugadores","client","nombre","sala","espera","usrIdx","usr"],"sources":["/home/csgarciamartinez/Telar/telar-client/src/Sala.js"],"sourcesContent":["import { io } from 'socket.io-client';\nimport Jugador from './Jugador';\nimport ItemTypes from './ItemTypes'\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport'./sala.css';\nimport {DndProvider, useDrag, useDrop} from 'react-dnd'\nimport{HTML5Backend} from 'react-dnd-html5-backend'\n\n\n//Called from Sala to start the game. Probably not in the right place\nfunction comenzar(skt, salaname){\n  console.log(`Se mando un request para comenzar el juego`);\n  skt.current.emit('comenzar-juego', salaname);\n};\n\nfunction GoButton(props){\n    let onClick = () => alert(\"No es tu turno\")\n    let style = {opacity: \"50%\"}\n    if(props.jugador.props.socket){\n      if(props.jugador.props.socket.current.id == props.turno){\n        var quedanFichas = []\n        for(const s in props.jugador.state.subset){\n          var subs = [props.jugador.state.subset[s]]\n          quedanFichas.push(true)\n          for(const f in props.jugador.state.fichasEnCanasta){\n            var ficha = props.jugador.state.fichasEnCanasta[f]\n            if(props.jugador.state.subset.includes(ficha[\"patron\"]) || props.jugador.state.subset.includes(ficha[\"color\"])) {\n              console.log(`Aun quedan fichas en subconjunto ${subs}`)\n              quedanFichas[s] = false\n              break\n            }\n          }\n        }\n        // }\n        onClick = () => alert(\"Favor de seleccionar un subconjunto completo\")\n        if(quedanFichas.length > 0 ){\n          if(quedanFichas.reduce((x, y) => x || y)){\n            style = {}\n            onClick= ()=>alert(\"this.hacerJugada()\")\n          }\n        } else {\n          onClick= ()=>alert(\"this.hacerJugada()\")\n        }\n      }\n    }\n    return(<button style = {style} onClick={onClick}>Hacer jugada</button>)\n}\n\n//Sala. Props inclused sala and socket info\n//TODO: Fix everything related to \"espera\", incl the fact you can play during it\nfunction Sala(props){\n  console.log(`Se actualizo la sala de juego`)\n  var jugadores = [];\n\n  const client = props.socket;\n  const nombre = props.sala[\"sala\"]\n  var espera = \"\"\n  var usrIdx = 0 //La posicion del jugador en la sala\n\n  if(props.sala[\"activo\"]){\n    for(const usr in props.sala[\"usuarios\"]){\n      console.log(props.sala[\"usuarios\"][usr][\"usuario\"])\n      console.log(client.current.id)\n      if(props.sala[\"usuarios\"][usr][\"usuario\"] == client.current.id){\n        jugadores.push(<Jugador jugador = {usr}\n                              activo = {true}\n                              sala = {props.sala}\n                              socket = {client}\n                              key = {props.sala[\"usuarios\"][usr][\"usuario\"]}/>)\n        usrIdx = usr\n      } else {\n        jugadores.push(<Jugador jugador = {usr}\n                              activo = {false}\n                              sala = {props.sala}\n                              socket = {client}\n                              key = {props.sala[\"usuarios\"][usr][\"usuario\"]}/>)\n      }\n    }\n  } else {\n    for(const usr in props.sala[\"usuarios\"]){\n      jugadores.push(<Jugador jugador = {usr}\n                              sala = {props.sala} \n                              key={props.sala[\"usuarios\"][usr][\"usuario\"]}/>);\n    }\n  }\n\n  if(props.sala[\"espera\"]){\n    espera = \"espera\"\n  }\n\n  return(\n    <DndProvider backend={HTML5Backend}>\n    <div> \n      <h1>Sala de juego \"{props.sala[\"sala\"]}\"</h1>\n      <div id = {espera}> </div>\n      <div class =\"sala\">\n        {props.sala[\"activo\"]\n          ? \n            <div>\n              <div class=\"jugadores\" key=\"boards1\">{jugadores}</div>\n              <div id =\"comenzarBtn\">\n                <GoButton jugador = {jugadores[usrIdx]}/>\n              </div>\n              </div>\n            :\n            <div>\n            <div class=\"jugadores\" key=\"boards2\"> \n            {jugadores}\n            </div>\n            <div id=\"comenzarBtn\">\n              <button onClick={() => comenzar(client, nombre)}>\n                Comenzar\n              </button>\n            </div>\n          </div>\n        }\n      </div>\n    </div>\n    </DndProvider>\n  )\n}\n\nexport default Sala;"],"mappings":"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"},"metadata":{},"sourceType":"module"}